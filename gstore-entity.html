<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>知识元详情 - 知识图谱管理系统 Powered by gStore</title>
    <!-- Bootstrap Styles-->
    <link href="assets/css/bootstrap.css" rel="stylesheet" />
    <!-- FontAwesome Styles-->
    <link href="assets/css/font-awesome.css" rel="stylesheet" />
    <!-- Morris Chart Styles-->

    <!-- Custom Styles-->
    <link href="assets/css/custom-styles.css" rel="stylesheet" />
    <!-- Google Fonts-->
    <link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css' />
    <!-- TABLE STYLES-->
    <link href="assets/js/dataTables/dataTables.bootstrap.css" rel="stylesheet" />
    <!-- DECEMBERCAFE STYLES-->
    <link href="assets/decembercafe/relationship.css" rel="stylesheet" />
</head>

<body>
    <div id="wrapper">

        <nav class="navbar navbar-default top-navbar" role="navigation">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".sidebar-collapse">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="index.html">gStore</a>
            </div>

        </nav>
        <!--/. NAV TOP  -->

        <nav class="navbar-default navbar-side" role="navigation">
            <div class="sidebar-collapse">
                <ul class="nav" id="main-menu">
                    <li>
                        <a id="a-dash" href="gstore-dashboard.html"><i class="fa fa-fw fa-file"></i> 控制面板 </a>
                    </li>
                    <li>
                        <a id="a-tb" href="gstore-table.html"><i class="fa fa-fw fa-file"></i> 列表视图 </a>
                    </li>
                    <li>
                        <a id="a-gr" href="gstore-graph.html"><i class="fa fa-fw fa-file"></i> 图谱视图 </a>
                    </li>
                    <li>
                        <a id="a-dt" href="gstore-entity.html" class="active-menu"><i class="fa fa-fw fa-file"></i> 知识元详情 </a>
                    </li>
                    <li>
                        <a id="a-sp" href="gstore-sparql.html"><i class="fa fa-fw fa-file"></i> SPARQL查询 </a>
                    </li>
                    <li>
                        <a id="a-hp" href="gstore-help.html"><i class="fa fa-fw fa-file"></i> 帮助 </a>
                    </li>
                </ul>
            </div>
        </nav>
        <!-- /. NAV SIDE  -->

        <div id="page-wrapper">
            <div id="page-inner">
                <div class="row">
                    <div class="col-md-12">
                        <h1 class="page-header">
                            <span id="entity-name"></span> <small>知识元详情</small>
                        </h1>
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-12">
                        <div class="showcase">
                            <canvas id="entity-canvas" height="1000" width="1300" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></canvas>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-12">
                    </div>
                </div>

                <footer>
                    <p>All right reserved. Template by: <a href="http://webthemez.com ">WebThemez</a></p>
                </footer>
            </div>
            <!-- /. PAGE INNER  -->
        </div>
        <!-- /. PAGE WRAPPER  -->
        <!-- /. WRAPPER  -->
        <!-- JS Scripts-->
        <!-- jQuery Js -->
        <script src="assets/js/jquery-1.10.2.js "></script>
        <!-- Bootstrap Js -->
        <script src="assets/js/bootstrap.min.js "></script>
        <!-- Metis Menu Js -->
        <script src="assets/js/jquery.metisMenu.js "></script>
        <!-- DATA TABLE SCRIPTS -->
        <script src="assets/js/dataTables/jquery.dataTables.js "></script>
        <script src="assets/js/dataTables/dataTables.bootstrap.js "></script>
        <!-- Custom Js -->
        <script src="assets/js/gstore-util.js"></script>
        <script src="assets/js/gstore-gstore.js"></script>
        <script src="assets/decembercafe/d3.min.js"></script>
        <script src="assets/decembercafe/relation.js"></script>

        <script>
            $(document).ready(function () {

                function setURL() {
                    $("#a-dash")[0].href = getURL($("#a-dash")[0].href, { "ip": global_ip, "port": global_port, "db": global_dbname });
                    $("#a-tb")[0].href = getURL($("#a-tb")[0].href, { "ip": global_ip, "port": global_port, "db": global_dbname });
                    $("#a-gr")[0].href = getURL($("#a-gr")[0].href, { "ip": global_ip, "port": global_port, "db": global_dbname });
                    $("#a-dt")[0].href = getURL($("#a-dt")[0].href, { "ip": global_ip, "port": global_port, "db": global_dbname });
                    $("#a-sp")[0].href = getURL($("#a-sp")[0].href, { "ip": global_ip, "port": global_port, "db": global_dbname });
                    $("#a-hp")[0].href = getURL($("#a-hp")[0].href, { "ip": global_ip, "port": global_port, "db": global_dbname });
                }

                var params = parseURL(document.URL);
                if (Object.keys(params).length > 0) {
                    global_ip = params["ip"];
                    global_port = params["port"];
                    global_dbname = params["db"];

                    setURL();
                }

                function getEntityShortName(eid) {
                    return eid.substring(eid.lastIndexOf('/') + 1);
                }

                var entity_id = "http://www.summba.com/ontologies/music/周杰伦"
                if (document.location.hash.length > 0) {
                    entity_id = document.location.hash.substring(1);
                }
                $("#entity-name").text(getEntityShortName(entity_id));

                // init entity graph

                function initColor(r) {
                    r[0].color = "#007FFF",
                        r[1].color = "#A142FF",
                        r[2].color = "#FF85C2",
                        r[3].color = "#FFA142",
                        r[4].color = "#FF4242";

                    for (var o = 5; o < r.length; o++) {
                        var t = d3.color(r[o % 4 + 1].color);
                        r[o].color = t.brighter(1.5).toString()
                    }
                }

                function initRadius(r) {
                    r[0].radius = 18;
                    // r[1].radius = 14,
                    // r[2].radius = 14,
                    // r[3].radius = 14,
                    // r[4].radius = 14;
                    for (var o = 1; o < r.length; o++)
                        r[o].radius = 10
                }

                var canvas = document.querySelector("canvas"),
                    width = 1300,
                    height = 1000;

                // mycsv = "id,name\n0,Geoff\n1,School\n2,Company\n3,Family\n4,Network\n5,Aaron\n6,Abbott\n7,Jacob\n8,James\n9,Kelvin\n10,Kendall\n11,Kendrick\n12,Leroy\n13,Leslie\n14,Lester\n15,Magnus\n16,Malcolm\n17,Melvin\n18,Perry\n19,Peter\n20,Peyton\n21,Royce\n22,Rufus\n23,Rupert\n24,Hadden\n25,Hadley\n26,Hadwin\n27,Hal\n28,Halbert\n29,Halden\n30,Hale\n31,Gilroy\n32,Glenn\n33,Goddard\n34,Godfrey\n35,Godwin\n36,Graham\n37,Grant\n38,Tobias\n39,Toby\n40,Todd\n41,Tony\n42,Travis\n43,Trent\n44,Trevor\n45,Tristan\n46,Troy\n47,Truman\n48,Tyler";

                function initGraph(nodes, edges) {
                    var o = nodes.map(x => ({ id: x[0], name: x[1] }));

                    var i = edges.map(x => ({ source: x[0], target: x[1], label: x[2], isuri: x[3] }));

                    // for (var t = (o.length, 4), i = [], e = 1; e <= t; e++)
                    //     i.push({ source: 0, target: e });

                    // for (var e = t + 1; e < o.length; e++)
                    //     i.push({ source: e % t + 1, target: e });

                    console.log(o);
                    console.log(i);

                    initColor(o),
                        initRadius(o);

                    var s = new relation;
                    s.setNodes(o),
                        s.setLinks(i),
                        s.setCanvas(canvas),
                        s.setSize(width, height),
                        s.setRadius(12),
                        s.setLinkLength(90),
                        s.setCharge(-60),
                        s.init(),
                        s.run()
                }

                gstore.getEntityGraphData(
                    entity_id,
                    initGraph,
                    function () { }
                )

                // init(d3.csvParse(mycsv))
            });
        </script>

</body>

</html>